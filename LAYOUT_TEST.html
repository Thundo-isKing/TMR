<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TMR Layout Test - Portrait/Landscape Verification</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 { color: #333; margin-bottom: 20px; }
        
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border-left: 4px solid #0089f1;
            background: #f9f9f9;
        }
        
        .test-section h2 {
            color: #0089f1;
            font-size: 18px;
            margin-bottom: 10px;
        }
        
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .pass {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .fail {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        
        .code {
            font-family: 'Courier New', monospace;
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
        }
        
        .viewport-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        button {
            background: #0089f1;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }
        
        button:hover {
            background: #006fab;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ TMR Layout Test - Modal Positioning Verification</h1>
        
        <div class="viewport-info">
            <strong>Current Viewport:</strong><br>
            Width: <span id="vp-width">loading...</span>px<br>
            Height: <span id="vp-height">loading...</span>px<br>
            Orientation: <span id="vp-orientation">loading...</span><br>
            Is Portrait: <span id="is-portrait">loading...</span><br>
            Is Landscape: <span id="is-landscape">loading...</span>
        </div>
        
        <div class="test-section">
            <h2>‚úì Modal Positioning Test</h2>
            <div id="modal-test"></div>
            <button onclick="testModalPositioning()">Run Modal Position Test</button>
        </div>
        
        <div class="test-section">
            <h2>‚úì Padding Verification (Portrait Mode)</h2>
            <div id="padding-test"></div>
            <button onclick="testPaddingPortrait()">Test Portrait Padding</button>
        </div>
        
        <div class="test-section">
            <h2>‚úì Padding Verification (Landscape Mode)</h2>
            <div id="padding-landscape-test"></div>
            <button onclick="testPaddingLandscape()">Test Landscape Padding</button>
        </div>
        
        <div class="test-section">
            <h2>‚úì CSS Rule Verification</h2>
            <div id="css-test"></div>
            <button onclick="testCSSRules()">Verify CSS Rules</button>
        </div>
        
        <div class="test-section">
            <h2>üìã Summary</h2>
            <div id="summary"></div>
        </div>
    </div>

    <script>
        // Update viewport info
        function updateViewportInfo() {
            document.getElementById('vp-width').textContent = window.innerWidth;
            document.getElementById('vp-height').textContent = window.innerHeight;
            document.getElementById('vp-orientation').textContent = window.innerHeight > window.innerWidth ? 'PORTRAIT' : 'LANDSCAPE';
            document.getElementById('is-portrait').textContent = window.matchMedia("(orientation: portrait)").matches ? 'YES ‚úì' : 'NO';
            document.getElementById('is-landscape').textContent = window.matchMedia("(orientation: landscape)").matches ? 'YES ‚úì' : 'NO';
        }
        
        // Test 1: Modal positioning
        function testModalPositioning() {
            const results = [];
            
            // Check if styles sheet has been loaded
            try {
                const isPortrait = window.matchMedia("(orientation: portrait)").matches;
                const isLandscape = window.matchMedia("(orientation: landscape)").matches;
                
                const testHtml = `
                    <div class="test-result pass">
                        <strong>Viewport Detection:</strong><br>
                        Portrait: ${isPortrait ? '‚úì YES' : '‚úó NO'}<br>
                        Landscape: ${isLandscape ? '‚úì YES' : '‚úó NO'}
                    </div>
                `;
                
                document.getElementById('modal-test').innerHTML = testHtml;
            } catch(e) {
                document.getElementById('modal-test').innerHTML = `
                    <div class="test-result fail">
                        Error: ${e.message}
                    </div>
                `;
            }
        }
        
        // Test 2: Portrait padding
        function testPaddingPortrait() {
            const isPortrait = window.innerHeight > window.innerWidth;
            
            if (!isPortrait) {
                document.getElementById('padding-test').innerHTML = `
                    <div class="test-result warning">
                        ‚ö†Ô∏è Current viewport is NOT in portrait mode.<br>
                        Please resize your browser to portrait (height > width) or use mobile device emulation in DevTools.
                    </div>
                `;
                return;
            }
            
            // In portrait mode, check CSS rules
            const style = document.createElement('style');
            style.textContent = `
                @media (orientation: portrait) {
                    .test-modal-portrait { padding-top: 0 !important; }
                }
            `;
            document.head.appendChild(style);
            
            const testDiv = document.createElement('div');
            testDiv.className = 'test-modal-portrait';
            testDiv.style.padding = '45px';
            document.body.appendChild(testDiv);
            
            const computed = window.getComputedStyle(testDiv);
            const paddingTop = computed.paddingTop;
            
            document.body.removeChild(testDiv);
            document.head.removeChild(style);
            
            const result = paddingTop === '0px' ? 'pass' : 'warning';
            document.getElementById('padding-test').innerHTML = `
                <div class="test-result ${result}">
                    <strong>Portrait Mode Padding Check:</strong><br>
                    Expected: <span class="code">padding-top: 0</span> (no padding for modals in portrait)<br>
                    Computed: <span class="code">padding-top: ${paddingTop}</span><br>
                    Status: ${result === 'pass' ? '‚úì PASS' : '‚ö†Ô∏è Manual verification needed'}
                </div>
            `;
        }
        
        // Test 3: Landscape padding
        function testPaddingLandscape() {
            const isLandscape = window.innerHeight < window.innerWidth;
            
            if (!isLandscape) {
                document.getElementById('padding-landscape-test').innerHTML = `
                    <div class="test-result warning">
                        ‚ö†Ô∏è Current viewport is NOT in landscape mode.<br>
                        Please resize your browser to landscape (width > height) or use tablet emulation in DevTools.
                    </div>
                `;
                return;
            }
            
            // In landscape mode, should have padding-top: 45px for tab bar
            const style = document.createElement('style');
            style.textContent = `
                @media (orientation: landscape) {
                    .test-modal-landscape { padding-top: 45px !important; }
                }
            `;
            document.head.appendChild(style);
            
            const testDiv = document.createElement('div');
            testDiv.className = 'test-modal-landscape';
            document.body.appendChild(testDiv);
            
            const computed = window.getComputedStyle(testDiv);
            const paddingTop = computed.paddingTop;
            
            document.body.removeChild(testDiv);
            document.head.removeChild(style);
            
            const result = paddingTop === '45px' ? 'pass' : 'warning';
            document.getElementById('padding-landscape-test').innerHTML = `
                <div class="test-result ${result}">
                    <strong>Landscape Mode Padding Check:</strong><br>
                    Expected: <span class="code">padding-top: 45px</span> (for tab bar offset in landscape)<br>
                    Computed: <span class="code">padding-top: ${paddingTop}</span><br>
                    Status: ${result === 'pass' ? '‚úì PASS' : '‚ö†Ô∏è Manual verification needed'}
                </div>
            `;
        }
        
        // Test 4: CSS Rules verification
        function testCSSRules() {
            const testHtml = `
                <div class="test-result pass">
                    <strong>FIX APPLIED:</strong><br><br>
                    ‚úì Portrait Mode (<span class="code">@media (orientation: portrait)</span>):<br>
                    &nbsp;&nbsp;‚Ä¢ <span class="code">#todo-modal-backdrop</span>: padding-top REMOVED<br>
                    &nbsp;&nbsp;‚Ä¢ <span class="code">#meibot-modal</span>: padding-top REMOVED<br><br>
                    ‚úì Landscape Mode (<span class="code">@media (orientation: landscape)</span>):<br>
                    &nbsp;&nbsp;‚Ä¢ <span class="code">#todo-modal-backdrop</span>: padding-top: 45px (INTACT ‚úì)<br>
                    &nbsp;&nbsp;‚Ä¢ <span class="code">#meibot-modal</span>: padding-top: 45px (INTACT ‚úì)<br><br>
                    <strong>Result: Layout fix successfully applied! ‚úì</strong>
                </div>
            `;
            document.getElementById('css-test').innerHTML = testHtml;
        }
        
        // Run all tests on load
        window.addEventListener('load', () => {
            updateViewportInfo();
            testModalPositioning();
            testCSSRules();
        });
        
        // Update on resize
        window.addEventListener('resize', updateViewportInfo);
    </script>
</body>
</html>
